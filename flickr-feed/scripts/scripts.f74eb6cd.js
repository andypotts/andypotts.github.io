"use strict";angular.module("flickrApp",["ui.router","ngResource","angularUtils.directives.dirPagination"]).config(["$stateProvider","$urlRouterProvider","$sceDelegateProvider",function(a,b,c){b.otherwise("/"),a.state("home",{url:"/",component:"home"}).state("detail",{url:"/:id",component:"detail",params:{details:null}}),c.resourceUrlWhitelist(["self","https://*.flickr.com/**"])}]),angular.module("flickrApp").component("home",{templateUrl:"scripts/components/home/home.html",controller:["Flickr",function(a){var b=this;b.$onInit=function(){b.page=1,b.loadMoreImages()},b.loadMoreImages=function(){a.search({page:b.page}).$promise.then(function(c){b.images=c.photos,b.images.photo.forEach(function(b){a.getSizes({photo_id:b.id}).$promise.then(function(a){b.urls=a.sizes.size}),a.getInfo({photo_id:b.id}).$promise.then(function(a){b.info=a.photo})})})},b.pageChanged=function(a){b.page=a,window.scrollTo(0,0),b.loadMoreImages()}}]}),angular.module("flickrApp").component("detail",{templateUrl:"scripts/components/detail/detail.html",controller:["Flickr","$stateParams",function(a,b){var c=this;c.$onInit=function(){c.fail=!1;var d=b.id;c.image={},b.details?c.image=b.details:(a.getInfo({photo_id:d}).$promise.then(function(a){"fail"!==a.stat?c.image.info=a.photo:c.fail=!0}),a.getSizes({photo_id:d}).$promise.then(function(a){"fail"!==a.stat?c.image.urls=a.sizes.size:c.fail=!0}))}}]}),angular.module("flickrApp").factory("Flickr",["$http","$resource",function(a,b){var c="ef574fc61a71e59703edb89d0fba09e9",d="https://api.flickr.com/services/rest/?api_key="+c+"&format=json";return b(d,{},{search:{url:d,method:"JSONP",jsonpCallbackParam:"jsoncallback",params:{method:"flickr.photos.search",tags:"cat, kitten",per_page:15,media:"photos",sort:"interestingness-desc",safe_search:1}},getInfo:{url:d,method:"JSONP",jsonpCallbackParam:"jsoncallback",params:{method:"flickr.photos.getInfo",photo_id:"@id"}},getSizes:{url:d,method:"JSONP",jsonpCallbackParam:"jsoncallback",params:{method:"flickr.photos.getSizes",photo_id:"@id"}}})}]),angular.module("flickrApp").filter("stripHtml",function(){return function(a){return a?String(a).replace(/<[^>]+>/gm,""):""}}),angular.module("flickrApp").filter("customDate",function(){return function(a){return a?moment(1e3*a).format("Do MMM YYYY [at] H:mm"):""}});